FROM nexus3.inspq.qc.ca:5000/inspq/openjdk-11:11.0.4_11-LTS
#FROM nexus3.inspq.qc.ca:5000/inspq/openjdk-11:latest

ENV TZ=America/Toronto

ARG APP_VERSION=1.0.0
ENV APP_VERSION=$APP_VERSION
ARG JAR_FILE=app.jar
ENV JAR_FILE=${JAR_FILE}
ARG APP_HOME=/opt/app
ENV APP_HOME=${APP_HOME}
ARG SERVER_PORT=8080
ENV SERVER_PORT=${SERVER_PORT}
ARG MANAGEMENT_SERVER_PORT=28081
ENV MANAGEMENT_SERVER_PORT=${MANAGEMENT_SERVER_PORT}

RUN mkdir ${APP_HOME}
ADD target/${JAR_FILE} ${APP_HOME}/${JAR_FILE}
ADD docker-entrypoint.sh ${APP_HOME}/docker-entrypoint.sh

RUN chmod a+x ${APP_HOME}/docker-entrypoint.sh
EXPOSE ${SERVER_PORT} ${MANAGEMENT_SERVER_PORT}

ENTRYPOINT ${APP_HOME}/docker-entrypoint.sh