{% if 'https' == unamservice_virtualhost_protocol %}
<VirtualHost *:443>
	SSLEngine on
	{% if unamservice_cert_file %}
	SSLCertificateFile {{ cert_file_path }}/{{ unamservice_cert_file }}
	{% else %}
	SSLCertificateFile /etc/pki/tls/certs/localhost.crt
	{% endif %}
	{% if unamservice_cert_key %}
	SSLCertificateKeyFile {{ cert_key_path }}/{{ unamservice_cert_key }}
	{% else %}
	SSLCertificateKeyFile /etc/pki/tls/private/localhost.key
	{% endif %}
	SSLProxyEngine on
 	SSLProxyVerify none
 	SSLProxyCheckPeerName off
  	SSLProxyCheckPeerCN off
  	SSLProxyCheckPeerExpire off

{% else %}
<VirtualHost *:80>
{% endif %}
	ServerName {{ unamservice_base_url }}
	ProxyRequests Off
    ProxyPreserveHost On
    
	<Proxy *>
{% if 'https' == unamservice_protocol %}
		RequestHeader set X-Forwarded-Proto "https"
{% endif %}
		Order deny,allow
		Allow from all
	</Proxy>

	ProxyPass / http://localhost:{{ unamservice_external_port }}/
    ProxyPassReverse / http://localhost:{{ unamservice_external_port }}/
</VirtualHost>
